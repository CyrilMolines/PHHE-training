function i(t){return t.replace(/\u00a0/g," ").trim().replace(/\s+/g," ")}function S(t){const e=i(t);return e?e.split(",").map(n=>n.trim()).filter(Boolean):[]}function L(t){const e=i(t).toLowerCase();return e?e==="online"||e==="e-learning"||e==="elearning"?"online":e==="in-person"||e==="in person"||e==="inperson"?"in_person":e==="blended"?"blended":e==="training toolkits and packages"||e==="toolkit"||e==="toolkits"?"toolkit":"unknown":"unknown"}async function v(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(n)].map(o=>o.toString(16).padStart(2,"0")).join("").slice(0,24)}async function w(t,e){const n=i(t["Learning Name"]??""),a=i(t.Description??""),o=i(t["Technical area"]??""),s=i(t["Focus area"]??""),l=i(t["Intended audience"]??""),r=i(t.Owner??""),c=i(t.Developer??""),f=i(t["Contact details"]??""),u=S(t.Language??""),p=t.Modality??"",g=L(p),m=i(t.Platform??""),_=i(t.Link??""),h=i(t.Comment??""),k=i(t["Sign-off status"]??""),d=i(_.replace(/&amp;/g,"&")),y=[n,a,o,s,l,r,c,f,u.join(", "),m,d].join(" | ").toLowerCase();return{id:await v(`${n}||${d}`),sourceRow:e,learningName:n,description:a,technicalArea:o,focusArea:s,intendedAudience:l,owner:r,developer:c,contactDetails:f,languages:u,modalityRaw:i(p),modality:g,platform:m,link:_,comment:h,signoffStatus:k,normalizedLink:d,searchText:y}}function x(t,e){return`${t.siteRelativeUrl?t.siteRelativeUrl.replace(/\/+$/,""):""}${e}`}function $(t){const e=n=>{const a=t[n];return a==null?"":typeof a=="string"?a:String(a)};return{"Learning Name":e("field_2"),Description:e("field_3"),"Technical area":e("field_4"),"Focus area":e("field_8"),"Intended audience":e("field_11"),Owner:e("field_5"),Developer:e("field_7"),"Contact details":e("field_6"),Language:e("field_9"),Modality:e("field_12"),Platform:e("field_10"),Link:e("field_14"),Comment:e("field_17"),"Sign-off status":e("_Flow_SignoffStatus")}}async function T(t){const e=await fetch(t,{headers:{Accept:"application/json;odata=nometadata"},credentials:"same-origin"});if(!e.ok){const n=await e.text();throw new Error(`SharePoint REST error ${e.status} ${e.statusText}: ${n.slice(0,500)}`)}return await e.json()}async function b(t){const e=["Id","field_2","field_3","field_4","field_5","field_6","field_7","field_8","field_9","field_10","field_11","field_12","field_14","field_17","_Flow_SignoffStatus"].join(",");let n=x(t,`/_api/web/lists/getbytitle('${encodeURIComponent(t.listTitle)}')/items?$select=${e}&$top=5000`);const a=[];for(;n;){const o=await T(n),s=o.value??[];for(const l of s){const r=$(l),c=await w(r);a.push(c)}n=o["@odata.nextLink"]||o["odata.nextLink"]||""}return a}export{b as fetchAllListItems};
//# sourceMappingURL=sharepoint-BSZBMNpd.js.map
