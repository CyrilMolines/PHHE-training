const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./embeddings-CefqThTG.js","./transformers.web-Bp_hl43Q.js","./chatModel-Dp5WF3E6.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var ae,w,Xe,z,xe,Ze,et,tt,Pe,pe,me,Z={},nt=[],yt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ce=Array.isArray;function O(t,e){for(var n in e)t[n]=e[n];return t}function Le(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function vt(t,e,n){var r,i,o,s={};for(o in e)o=="key"?r=e[o]:o=="ref"?i=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?ae.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return ne(t,s,r,i,null)}function ne(t,e,n,r,i){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Xe,__i:-1,__u:0};return i==null&&w.vnode!=null&&w.vnode(o),o}function le(t){return t.children}function oe(t,e){this.props=t,this.context=e}function J(t,e){if(e==null)return t.__?J(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?J(t):null}function ot(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return ot(t)}}function Ae(t){(!t.__d&&(t.__d=!0)&&z.push(t)&&!ie.__r++||xe!=w.debounceRendering)&&((xe=w.debounceRendering)||Ze)(ie)}function ie(){for(var t,e,n,r,i,o,s,c=1;z.length;)z.length>c&&z.sort(et),t=z.shift(),c=z.length,t.__d&&(n=void 0,r=void 0,i=(r=(e=t).__v).__e,o=[],s=[],e.__P&&((n=O({},r)).__v=r.__v+1,w.vnode&&w.vnode(n),Ie(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[i]:null,o,i??J(r),!!(32&r.__u),s),n.__v=r.__v,n.__.__k[n.__i]=n,st(o,n,s),r.__e=r.__=null,n.__e!=i&&ot(n)));ie.__r=0}function rt(t,e,n,r,i,o,s,c,_,l,u){var a,h,f,y,E,k,b,v=r&&r.__k||nt,T=e.length;for(_=bt(n,e,v,_,T),a=0;a<T;a++)(f=n.__k[a])!=null&&(h=f.__i==-1?Z:v[f.__i]||Z,f.__i=a,k=Ie(t,f,h,i,o,s,c,_,l,u),y=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&Ce(h.ref,null,f),u.push(f.ref,f.__c||y,f)),E==null&&y!=null&&(E=y),(b=!!(4&f.__u))||h.__k===f.__k?_=it(f,_,t,b):typeof f.type=="function"&&k!==void 0?_=k:y&&(_=y.nextSibling),f.__u&=-7);return n.__e=E,_}function bt(t,e,n,r,i){var o,s,c,_,l,u=n.length,a=u,h=0;for(t.__k=new Array(i),o=0;o<i;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=t.__k[o]=ne(null,s,null,null,null):ce(s)?s=t.__k[o]=ne(le,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?s=t.__k[o]=ne(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):t.__k[o]=s,_=o+h,s.__=t,s.__b=t.__b+1,c=null,(l=s.__i=wt(s,n,_,a))!=-1&&(a--,(c=n[l])&&(c.__u|=2)),c==null||c.__v==null?(l==-1&&(i>u?h--:i<u&&h++),typeof s.type!="function"&&(s.__u|=4)):l!=_&&(l==_-1?h--:l==_+1?h++:(l>_?h--:h++,s.__u|=4))):t.__k[o]=null;if(a)for(o=0;o<u;o++)(c=n[o])!=null&&(2&c.__u)==0&&(c.__e==r&&(r=J(c)),ct(c,c));return r}function it(t,e,n,r){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=it(i[o],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=J(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function wt(t,e,n,r){var i,o,s,c=t.key,_=t.type,l=e[n],u=l!=null&&(2&l.__u)==0;if(l===null&&c==null||u&&c==l.key&&_==l.type)return n;if(r>(u?1:0)){for(i=n-1,o=n+1;i>=0||o<e.length;)if((l=e[s=i>=0?i--:o++])!=null&&(2&l.__u)==0&&c==l.key&&_==l.type)return s}return-1}function Te(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||yt.test(e)?n:n+"px"}function te(t,e,n,r,i){var o,s;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Te(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||Te(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(tt,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=Pe,t.addEventListener(e,o?me:pe,o)):t.removeEventListener(e,o?me:pe,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Re(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Pe++;else if(e.t<n.u)return;return n(w.event?w.event(e):e)}}}function Ie(t,e,n,r,i,o,s,c,_,l){var u,a,h,f,y,E,k,b,v,T,M,q,F,G,Q,W,X,D=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(_=!!(32&n.__u),o=[c=e.__e=n.__e]),(u=w.__b)&&u(e);e:if(typeof D=="function")try{if(b=e.props,v="prototype"in D&&D.prototype.render,T=(u=D.contextType)&&r[u.__c],M=u?T?T.props.value:u.__:r,n.__c?k=(a=e.__c=n.__c).__=a.__E:(v?e.__c=a=new D(b,M):(e.__c=a=new oe(b,M),a.constructor=D,a.render=Et),T&&T.sub(a),a.state||(a.state={}),a.__n=r,h=a.__d=!0,a.__h=[],a._sb=[]),v&&a.__s==null&&(a.__s=a.state),v&&D.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=O({},a.__s)),O(a.__s,D.getDerivedStateFromProps(b,a.__s))),f=a.props,y=a.state,a.__v=e,h)v&&D.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),v&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(v&&D.getDerivedStateFromProps==null&&b!==f&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(b,M),e.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(b,a.__s,M)===!1){for(e.__v!=n.__v&&(a.props=b,a.state=a.__s,a.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(N){N&&(N.__=e)}),q=0;q<a._sb.length;q++)a.__h.push(a._sb[q]);a._sb=[],a.__h.length&&s.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(b,a.__s,M),v&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(f,y,E)})}if(a.context=M,a.props=b,a.__P=t,a.__e=!1,F=w.__r,G=0,v){for(a.state=a.__s,a.__d=!1,F&&F(e),u=a.render(a.props,a.state,a.context),Q=0;Q<a._sb.length;Q++)a.__h.push(a._sb[Q]);a._sb=[]}else do a.__d=!1,F&&F(e),u=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++G<25);a.state=a.__s,a.getChildContext!=null&&(r=O(O({},r),a.getChildContext())),v&&!h&&a.getSnapshotBeforeUpdate!=null&&(E=a.getSnapshotBeforeUpdate(f,y)),W=u,u!=null&&u.type===le&&u.key==null&&(W=at(u.props.children)),c=rt(t,ce(W)?W:[W],e,n,r,i,o,s,c,_,l),a.base=e.__e,e.__u&=-161,a.__h.length&&s.push(a),k&&(a.__E=a.__=null)}catch(N){if(e.__v=null,_||o!=null)if(N.then){for(e.__u|=_?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,e.__e=c}else{for(X=o.length;X--;)Le(o[X]);ge(e)}else e.__e=n.__e,e.__k=n.__k,N.then||ge(e);w.__e(N,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=kt(n.__e,e,n,r,i,o,s,_,l);return(u=w.diffed)&&u(e),128&e.__u?void 0:c}function ge(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ge)}function st(t,e,n){for(var r=0;r<n.length;r++)Ce(n[r],n[++r],n[++r]);w.__c&&w.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){w.__e(o,i.__v)}})}function at(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ce(t)?t.map(at):O({},t)}function kt(t,e,n,r,i,o,s,c,_){var l,u,a,h,f,y,E,k=n.props||Z,b=e.props,v=e.type;if(v=="svg"?i="http://www.w3.org/2000/svg":v=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(l=0;l<o.length;l++)if((f=o[l])&&"setAttribute"in f==!!v&&(v?f.localName==v:f.nodeType==3)){t=f,o[l]=null;break}}if(t==null){if(v==null)return document.createTextNode(b);t=document.createElementNS(i,v,b.is&&b),c&&(w.__m&&w.__m(e,o),c=!1),o=null}if(v==null)k===b||c&&t.data==b||(t.data=b);else{if(o=o&&ae.call(t.childNodes),!c&&o!=null)for(k={},l=0;l<t.attributes.length;l++)k[(f=t.attributes[l]).name]=f.value;for(l in k)if(f=k[l],l!="children"){if(l=="dangerouslySetInnerHTML")a=f;else if(!(l in b)){if(l=="value"&&"defaultValue"in b||l=="checked"&&"defaultChecked"in b)continue;te(t,l,null,f,i)}}for(l in b)f=b[l],l=="children"?h=f:l=="dangerouslySetInnerHTML"?u=f:l=="value"?y=f:l=="checked"?E=f:c&&typeof f!="function"||k[l]===f||te(t,l,f,k[l],i);if(u)c||a&&(u.__html==a.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(a&&(t.innerHTML=""),rt(e.type=="template"?t.content:t,ce(h)?h:[h],e,n,r,v=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:n.__k&&J(n,0),c,_),o!=null)for(l=o.length;l--;)Le(o[l]);c||(l="value",v=="progress"&&y==null?t.removeAttribute("value"):y!=null&&(y!==t[l]||v=="progress"&&!y||v=="option"&&y!=k[l])&&te(t,l,y,k[l],i),l="checked",E!=null&&E!=t[l]&&te(t,l,E,k[l],i))}return t}function Ce(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(i){w.__e(i,n)}}function ct(t,e,n){var r,i;if(w.unmount&&w.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||Ce(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){w.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(i=0;i<r.length;i++)r[i]&&ct(r[i],e,n||typeof t.type!="function");n||Le(t.__e),t.__c=t.__=t.__e=void 0}function Et(t,e,n){return this.constructor(t,n)}function Pt(t,e,n){var r,i,o,s;e==document&&(e=document.documentElement),w.__&&w.__(t,e),i=(r=!1)?null:e.__k,o=[],s=[],Ie(e,t=e.__k=vt(le,null,[t]),i||Z,Z,e.namespaceURI,i?null:e.firstChild?ae.call(e.childNodes):null,o,i?i.__e:e.firstChild,r,s),st(o,t,s)}ae=nt.slice,w={__e:function(t,e,n,r){for(var i,o,s;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,r||{}),s=i.__d),s)return i.__E=i}catch(c){t=c}throw t}},Xe=0,oe.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=O({},this.state),typeof t=="function"&&(t=t(O({},n),this.props)),t&&O(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Ae(this))},oe.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Ae(this))},oe.prototype.render=le,z=[],Ze=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,et=function(t,e){return t.__v.__b-e.__v.__b},ie.__r=0,tt=/(PointerCapture)$|Capture$/i,Pe=0,pe=Re(!1),me=Re(!0);var Lt=0;function m(t,e,n,r,i,o){e||(e={});var s,c,_=e;if("ref"in _)for(c in _={},e)c=="ref"?s=e[c]:_[c]=e[c];var l={type:t,props:_,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Lt,__i:-1,__u:0,__source:i,__self:o};if(typeof t=="function"&&(s=t.defaultProps))for(c in s)_[c]===void 0&&(_[c]=s[c]);return w.vnode&&w.vnode(l),l}const It="modulepreload",Ct=function(t,e){return new URL(t,e).href},$e={},Y=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let s=function(u){return Promise.all(u.map(a=>Promise.resolve(a).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const c=document.getElementsByTagName("link"),_=document.querySelector("meta[property=csp-nonce]"),l=_?.nonce||_?.getAttribute("nonce");i=s(n.map(u=>{if(u=Ct(u,r),u in $e)return;$e[u]=!0;const a=u.endsWith(".css"),h=a?'[rel="stylesheet"]':"";if(!!r)for(let E=c.length-1;E>=0;E--){const k=c[E];if(k.href===u&&(!a||k.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${h}`))return;const y=document.createElement("link");if(y.rel=a?"stylesheet":It,a||(y.as="script"),y.crossOrigin="",y.href=u,l&&y.setAttribute("nonce",l),document.head.appendChild(y),a)return new Promise((E,k)=>{y.addEventListener("load",E),y.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return i.then(s=>{for(const c of s||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})};var ee,L,ue,Be,se=0,lt=[],I=w,Ne=I.__b,He=I.__r,Oe=I.diffed,Fe=I.__c,je=I.unmount,Ue=I.__;function Me(t,e){I.__h&&I.__h(L,t,se||e),se=0;var n=L.__H||(L.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function A(t){return se=1,Mt(ut,t)}function Mt(t,e,n){var r=Me(ee++,2);if(r.t=t,!r.__c&&(r.__=[ut(void 0,e),function(c){var _=r.__N?r.__N[0]:r.__[0],l=r.t(_,c);_!==l&&(r.__N=[l,r.__[1]],r.__c.setState({}))}],r.__c=L,!L.__f)){var i=function(c,_,l){if(!r.__c.__H)return!0;var u=r.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!o||o.call(this,c,_,l);var a=r.__c.props!==c;return u.forEach(function(h){if(h.__N){var f=h.__[0];h.__=h.__N,h.__N=void 0,f!==h.__[0]&&(a=!0)}}),o&&o.call(this,c,_,l)||a};L.__f=!0;var o=L.shouldComponentUpdate,s=L.componentWillUpdate;L.componentWillUpdate=function(c,_,l){if(this.__e){var u=o;o=void 0,i(c,_,l),o=u}s&&s.call(this,c,_,l)},L.shouldComponentUpdate=i}return r.__N||r.__}function We(t,e){var n=Me(ee++,3);!I.__s&&dt(n.__H,e)&&(n.__=t,n.u=e,L.__H.__h.push(n))}function St(t){return se=5,_t(function(){return{current:t}},[])}function _t(t,e){var n=Me(ee++,7);return dt(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Dt(){for(var t;t=lt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(re),t.__H.__h.forEach(ye),t.__H.__h=[]}catch(e){t.__H.__h=[],I.__e(e,t.__v)}}I.__b=function(t){L=null,Ne&&Ne(t)},I.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Ue&&Ue(t,e)},I.__r=function(t){He&&He(t),ee=0;var e=(L=t.__c).__H;e&&(ue===L?(e.__h=[],L.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(re),e.__h.forEach(ye),e.__h=[],ee=0)),ue=L},I.diffed=function(t){Oe&&Oe(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(lt.push(e)!==1&&Be===I.requestAnimationFrame||((Be=I.requestAnimationFrame)||xt)(Dt)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ue=L=null},I.__c=function(t,e){e.some(function(n){try{n.__h.forEach(re),n.__h=n.__h.filter(function(r){return!r.__||ye(r)})}catch(r){e.some(function(i){i.__h&&(i.__h=[])}),e=[],I.__e(r,n.__v)}}),Fe&&Fe(t,e)},I.unmount=function(t){je&&je(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{re(r)}catch(i){e=i}}),n.__H=void 0,e&&I.__e(e,n.__v))};var Ve=typeof requestAnimationFrame=="function";function xt(t){var e,n=function(){clearTimeout(r),Ve&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Ve&&(e=requestAnimationFrame(n))}function re(t){var e=L,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),L=e}function ye(t){var e=L;t.__c=t.__(),L=e}function dt(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function ut(t,e){return typeof e=="function"?e(t):e}async function At(){const t=await fetch("./demo-trainings.json",{credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to load demo-trainings.json (${t.status})`);const e=await t.json();if(!Array.isArray(e))throw new Error("demo-trainings.json is not an array");return e}function ft(t){return t.toLowerCase().replace(/[^a-z0-9]+/gi," ").trim().split(/\s+/).filter(e=>e.length>=2)}function ze(t){const e=new Map,n=[];let r=0;for(const i of t){const o=ft(i.searchText),s=new Map;for(const _ of o)s.set(_,(s.get(_)??0)+1);for(const _ of s.keys())e.set(_,(e.get(_)??0)+1);const c=o.length;r+=c,n.push({record:i,tf:s,len:c})}return{docs:n,df:e,avgLen:n.length?r/n.length:0,n:n.length}}function Tt(t,e){const i=ft(e),o=new Map;for(const s of t.docs){let c=0;for(const _ of i){const l=s.tf.get(_)??0;if(!l)continue;const u=t.df.get(_)??0,a=Math.log(1+(t.n-u+.5)/(u+.5)),h=l+1.2*(1-.75+.75*s.len/(t.avgLen||1));c+=a*(l*(1.2+1)/h)}c>0&&o.set(s.record.id,c)}return o}function Rt(t,e){return t.filter(n=>{if(e.modality&&n.modality!==e.modality)return!1;if(e.language){const r=e.language.toLowerCase();if(!n.languages.some(i=>i.toLowerCase()===r))return!1}if(e.platform){const r=e.platform.toLowerCase();if(!n.platform.toLowerCase().includes(r))return!1}if(e.audienceContains){const r=e.audienceContains.toLowerCase();if(!n.intendedAudience.toLowerCase().includes(r))return!1}return!0})}function Ke(t,e,n){const r=Tt(n,e),i=[];for(const o of t){const s=r.get(o.id)??0;if(s<=0)continue;const c=[];o.learningName.toLowerCase().includes(e.toLowerCase())&&c.push("title match"),i.push({record:o,score:s,reasons:c})}return i.sort((o,s)=>s.score-o.score),i}const ve=(t,e)=>e.some(n=>t instanceof n);let qe,Ge;function $t(){return qe||(qe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Bt(){return Ge||(Ge=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const be=new WeakMap,fe=new WeakMap,_e=new WeakMap;function Nt(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(K(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return _e.set(e,t),e}function Ht(t){if(be.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});be.set(t,e)}let we={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return be.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return K(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ht(t){we=t(we)}function Ot(t){return Bt().includes(t)?function(...e){return t.apply(ke(this),e),K(this.request)}:function(...e){return K(t.apply(ke(this),e))}}function Ft(t){return typeof t=="function"?Ot(t):(t instanceof IDBTransaction&&Ht(t),ve(t,$t())?new Proxy(t,we):t)}function K(t){if(t instanceof IDBRequest)return Nt(t);if(fe.has(t))return fe.get(t);const e=Ft(t);return e!==t&&(fe.set(t,e),_e.set(e,t)),e}const ke=t=>_e.get(t);function jt(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),c=K(s);return r&&s.addEventListener("upgradeneeded",_=>{r(K(s.result),_.oldVersion,_.newVersion,K(s.transaction),_)}),n&&s.addEventListener("blocked",_=>n(_.oldVersion,_.newVersion,_)),c.then(_=>{o&&_.addEventListener("close",()=>o()),i&&_.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),c}const Ut=["get","getKey","getAll","getAllKeys","count"],Wt=["put","add","delete","clear"],he=new Map;function Qe(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(he.get(e))return he.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Wt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Ut.includes(n)))return;const o=async function(s,...c){const _=this.transaction(s,i?"readwrite":"readonly");let l=_.store;return r&&(l=l.index(c.shift())),(await Promise.all([l[n](...c),i&&_.done]))[0]};return he.set(e,o),o}ht(t=>({...t,get:(e,n,r)=>Qe(e,n)||t.get(e,n,r),has:(e,n)=>!!Qe(e,n)||t.has(e,n)}));const Vt=["continue","continuePrimaryKey","advance"],Ye={},Ee=new WeakMap,pt=new WeakMap,zt={get(t,e){if(!Vt.includes(e))return t[e];let n=Ye[e];return n||(n=Ye[e]=function(...r){Ee.set(this,pt.get(this)[e](...r))}),n}};async function*Kt(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,zt);for(pt.set(n,e),_e.set(n,ke(e));e;)yield n,e=await(Ee.get(n)||e.continue()),Ee.delete(n)}function Je(t,e){return e===Symbol.asyncIterator&&ve(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&ve(t,[IDBIndex,IDBObjectStore])}ht(t=>({...t,get(e,n,r){return Je(e,n)?Kt:t.get(e,n,r)},has(e,n){return Je(e,n)||t.has(e,n)}}));const qt="who-training-finder-db",Gt=1,mt="trainings";async function de(){return jt(qt,Gt,{upgrade(t){t.objectStoreNames.contains("trainings")||t.createObjectStore("trainings"),t.objectStoreNames.contains("embeddings")||t.createObjectStore("embeddings")}})}async function Qt(){return(await(await de()).get("trainings",mt))?.records??null}async function Yt(t){await(await de()).put("trainings",{updatedAt:Date.now(),records:t},mt)}async function Jt(t){const n=await(await de()).get("embeddings",t);return n?new Float32Array(n.data):null}async function Xt(t,e){const n=await de(),r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i=new Uint8Array(r.byteLength);i.set(r),await n.put("embeddings",{dims:e.length,data:i.buffer},t)}const S={dataSource:"demo_json",sharepoint:{siteRelativeUrl:"/sites/EuroWCPHE",listTitle:"Copytraininglist2912026"},embeddingModel:"bge-small",allowRemoteModels:!0,modelsBasePath:"./models"};function Zt(){const[t,e]=A(null),[n,r]=A(null),[i,o]=A("idle"),[s,c]=A(0),[_,l]=A("Initializing..."),[u,a]=A(!1),[h,f]=A(!1),[y,E]=A([]),[k,b]=A(""),[v,T]=A(null),[M,q]=A(null),F=St(null);We(()=>{F.current?.scrollIntoView({behavior:"smooth"})},[y.length,v]);const G=_t(()=>i==="ready",[i]);We(()=>{Q()},[]);async function Q(){o("data"),l("Loading training data..."),c(5);try{const d=await Qt();d&&d.length&&(e(d),r(ze(d)),c(15));const g=S.dataSource==="demo_json"?await At():await W();e(g),r(ze(g)),await Yt(g),c(30)}catch(d){console.error("Failed to load data:",d),E([{role:"bot",text:"Error loading training data. Please refresh the page."}]);return}o("embeddings"),l("Loading semantic search model...");try{const{loadEmbeddingsPipeline:d}=await Y(async()=>{const{loadEmbeddingsPipeline:g}=await import("./embeddings-CefqThTG.js");return{loadEmbeddingsPipeline:g}},__vite__mapDeps([0,1]),import.meta.url);await d({modelsBasePath:S.modelsBasePath,allowRemoteModels:S.allowRemoteModels,embeddingModel:S.embeddingModel}),a(!0),c(70)}catch(d){console.error("Failed to load embeddings:",d),c(70)}o("ai"),l("Loading AI assistant...");try{const{loadChatModel:d}=await Y(async()=>{const{loadChatModel:g}=await import("./chatModel-Dp5WF3E6.js");return{loadChatModel:g}},__vite__mapDeps([2,1]),import.meta.url);await d({modelsBasePath:S.modelsBasePath,allowRemoteModels:S.allowRemoteModels}),f(!0),c(100)}catch(d){console.error("Failed to load chat model:",d),c(100)}o("ready"),l(""),E([{role:"bot",text:"Hello! Tell me what training you're looking for - describe the topic, your goals, preferred language, or format (online/in-person)."}])}async function W(){const{fetchAllListItems:d}=await Y(async()=>{const{fetchAllListItems:g}=await import("./sharepoint-BSZBMNpd.js");return{fetchAllListItems:g}},[],import.meta.url);return d({siteRelativeUrl:S.sharepoint.siteRelativeUrl,listTitle:S.sharepoint.listTitle})}async function X(d){if(!t||!n)return;const g=y.length;E(B=>[...B,{role:"bot",text:"Searching...",isLoading:!0}]);let p;if(h)try{const{extractIntent:B,loadChatModel:j}=await Y(async()=>{const{extractIntent:x,loadChatModel:C}=await import("./chatModel-Dp5WF3E6.js");return{extractIntent:x,loadChatModel:C}},__vite__mapDeps([2,1]),import.meta.url),V=await j({modelsBasePath:S.modelsBasePath,allowRemoteModels:S.allowRemoteModels});p=await B(V,d)}catch{p=D(d)}else p=D(d);q(p);const P=Rt(t,{modality:p.modality,language:p.language,platform:p.platform,audienceContains:p.audience});let R;u?R=await gt(P,p.topic,n):R=Ke(P,p.topic,n);const $=R.slice(0,10);T($);let H;if(h&&$.length>0)try{const{generateResponse:B,loadChatModel:j}=await Y(async()=>{const{generateResponse:C,loadChatModel:U}=await import("./chatModel-Dp5WF3E6.js");return{generateResponse:C,loadChatModel:U}},__vite__mapDeps([2,1]),import.meta.url),V=await j({modelsBasePath:S.modelsBasePath,allowRemoteModels:S.allowRemoteModels}),x=$.slice(0,5).map(C=>({name:C.record.learningName,description:C.record.description,technicalArea:C.record.technicalArea,focusArea:C.record.focusArea,platform:C.record.platform,languages:C.record.languages,modality:C.record.modalityRaw}));H=await B(V,p,x,R.length)}catch{H=N(p,R.length)}else H=N(p,R.length);E(B=>{const j=[...B];return j[g]={role:"bot",text:H},j})}function D(d){const g=d.toLowerCase();let p=d;const P={topic:d,rawQuery:d},R=["english","french","spanish","russian","arabic","portuguese","chinese","ukrainian","polish"];for(const $ of R){const H=new RegExp(`\\b(in\\s+)?${$}\\b`,"gi");if(H.test(g)){P.language=$.charAt(0).toUpperCase()+$.slice(1),p=p.replace(H,"");break}}return/\bonline\b|e-learning/i.test(g)?(P.modality="online",p=p.replace(/\bonline\b|e-learning/gi,"")):/\bin[- ]person\b/i.test(g)?(P.modality="in_person",p=p.replace(/\bin[- ]person\b/gi,"")):/\bblended\b/i.test(g)&&(P.modality="blended",p=p.replace(/\bblended\b/gi,"")),/openwho/i.test(g)?(P.platform="OpenWHO",p=p.replace(/openwho/gi,"")):/who academy/i.test(g)?(P.platform="WHO Academy",p=p.replace(/who academy/gi,"")):/hslp/i.test(g)&&(P.platform="HSLP",p=p.replace(/hslp/gi,"")),/member state|ministry/i.test(g)?P.audience="Member":/who staff/i.test(g)&&(P.audience="WHO"),p=p.replace(/\b(i need|i want|i'm looking for|looking for|find me|show me|a training|training|about|on|for)\b/gi,"").replace(/\s+/g," ").trim(),P.topic=p||"health emergency",P}function N(d,g){if(g===0)return`I couldn't find any trainings matching "${d.topic}". Try broadening your search.`;const p=[];d.language&&p.push(`in ${d.language}`),d.modality&&p.push(d.modality.replace("_","-")),d.platform&&p.push(`on ${d.platform}`);const P=p.length?` (${p.join(", ")})`:"";return`Found ${g} training(s) for "${d.topic}"${P}:`}async function gt(d,g,p){const P=Ke(d,g,p);if(P.length===0||!u)return P;try{const{cosineSimilarity:R,embedText:$,loadEmbeddingsPipeline:H}=await Y(async()=>{const{cosineSimilarity:x,embedText:C,loadEmbeddingsPipeline:U}=await import("./embeddings-CefqThTG.js");return{cosineSimilarity:x,embedText:C,loadEmbeddingsPipeline:U}},__vite__mapDeps([0,1]),import.meta.url),B=await H({modelsBasePath:S.modelsBasePath,allowRemoteModels:S.allowRemoteModels,embeddingModel:S.embeddingModel}),j=await $(B,g),V=P.slice(0,50);for(const x of V){const C=x.record.id;let U=await Jt(C);U||(U=await $(B,x.record.searchText),await Xt(C,U));const De=R(j,U);x.score=x.score+De*2,De>.35&&x.reasons.push("semantic match")}return V.sort((x,C)=>C.score-x.score),V}catch{return P}}async function Se(){const d=k.trim();!d||!G||(b(""),E(g=>[...g,{role:"user",text:d}]),await X(d))}return m("div",{class:"embed-container",children:[i!=="ready"&&m("div",{class:"loading-overlay",children:m("div",{class:"loading-content",children:[m("div",{class:"loading-title",children:"WHO Training Finder"}),m("div",{class:"loading-bar-container",children:m("div",{class:"loading-bar",style:{width:`${s}%`}})}),m("div",{class:"loading-text",children:_}),m("div",{class:"loading-percent",children:[s,"%"]})]})}),m("div",{class:`embed-main ${i!=="ready"?"hidden":""}`,children:[m("div",{class:"embed-header",children:m("span",{class:"embed-title",children:"WHO Training Finder"})}),m("div",{class:"embed-chat",children:[m("div",{class:"embed-messages",children:[y.map((d,g)=>m("div",{class:`embed-message ${d.role} ${d.isLoading?"loading":""}`,children:[d.isLoading&&m("span",{class:"spinner"}),d.text]},g)),m("div",{ref:F})]}),m("div",{class:"embed-composer",children:[m("input",{type:"text",value:k,placeholder:"Describe the training you need...",disabled:!G,onInput:d=>b(d.target.value),onKeyDown:d=>{d.key==="Enter"&&Se()}}),m("button",{class:"embed-send",disabled:!G,onClick:()=>void Se(),children:"Search"})]})]}),v&&v.length>0&&m("div",{class:"embed-results",children:[M&&m("div",{class:"embed-filters",children:[m("strong",{children:"Topic:"})," ",M.topic,M.language&&m("span",{class:"filter-pill",children:M.language}),M.modality&&m("span",{class:"filter-pill",children:M.modality}),M.platform&&m("span",{class:"filter-pill",children:M.platform})]}),v.map((d,g)=>m("div",{class:"embed-card",children:[m("div",{class:"card-title",children:d.record.learningName}),m("div",{class:"card-desc",children:[d.record.description?.slice(0,150),d.record.description?.length>150?"...":""]}),m("div",{class:"card-tags",children:[d.record.technicalArea&&m("span",{class:"tag",children:d.record.technicalArea}),d.record.modality&&d.record.modality!=="unknown"&&m("span",{class:"tag",children:d.record.modality}),d.record.platform&&m("span",{class:"tag",children:d.record.platform}),d.record.languages.length>0&&m("span",{class:"tag",children:d.record.languages.slice(0,3).join(", ")})]}),d.record.normalizedLink&&m("a",{class:"card-link",href:d.record.normalizedLink,target:"_blank",rel:"noreferrer",children:"Open training â†’"})]},g))]})]})]})}Pt(m(Zt,{}),document.getElementById("app"));
//# sourceMappingURL=main-BxwYRaY4.js.map
