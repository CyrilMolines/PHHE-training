(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();var ee,w,Pe,F,ue,Ee,Se,Te,ie,re,se,q={},Ne=[],je=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,te=Array.isArray;function H(e,t){for(var n in t)e[n]=t[n];return e}function ae(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Be(e,t,n){var s,l,r,a={};for(r in t)r=="key"?s=t[r]:r=="ref"?l=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?ee.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)a[r]===void 0&&(a[r]=e.defaultProps[r]);return J(e,a,s,l,null)}function J(e,t,n,s,l){var r={type:e,props:t,key:n,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++Pe,__i:-1,__u:0};return l==null&&w.vnode!=null&&w.vnode(r),r}function V(e){return e.children}function Q(e,t){this.props=e,this.context=t}function j(e,t){if(t==null)return e.__?j(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?j(e):null}function Re(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Re(e)}}function fe(e){(!e.__d&&(e.__d=!0)&&F.push(e)&&!Y.__r++||ue!=w.debounceRendering)&&((ue=w.debounceRendering)||Ee)(Y)}function Y(){for(var e,t,n,s,l,r,a,d=1;F.length;)F.length>d&&F.sort(Se),e=F.shift(),d=F.length,e.__d&&(n=void 0,s=void 0,l=(s=(t=e).__v).__e,r=[],a=[],t.__P&&((n=H({},s)).__v=s.__v+1,w.vnode&&w.vnode(n),_e(t.__P,n,s,t.__n,t.__P.namespaceURI,32&s.__u?[l]:null,r,l??j(s),!!(32&s.__u),a),n.__v=s.__v,n.__.__k[n.__i]=n,Ue(r,n,a),s.__e=s.__=null,n.__e!=l&&Re(n)));Y.__r=0}function Ae(e,t,n,s,l,r,a,d,f,_,u){var o,h,v,p,C,$,b,k=s&&s.__k||Ne,N=t.length;for(f=Me(n,t,k,f,N),o=0;o<N;o++)(v=n.__k[o])!=null&&(h=v.__i==-1?q:k[v.__i]||q,v.__i=o,$=_e(e,v,h,l,r,a,d,f,_,u),p=v.__e,v.ref&&h.ref!=v.ref&&(h.ref&&ce(h.ref,null,v),u.push(v.ref,v.__c||p,v)),C==null&&p!=null&&(C=p),(b=!!(4&v.__u))||h.__k===v.__k?f=He(v,f,e,b):typeof v.type=="function"&&$!==void 0?f=$:p&&(f=p.nextSibling),v.__u&=-7);return n.__e=C,f}function Me(e,t,n,s,l){var r,a,d,f,_,u=n.length,o=u,h=0;for(e.__k=new Array(l),r=0;r<l;r++)(a=t[r])!=null&&typeof a!="boolean"&&typeof a!="function"?(typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?a=e.__k[r]=J(null,a,null,null,null):te(a)?a=e.__k[r]=J(V,{children:a},null,null,null):a.constructor===void 0&&a.__b>0?a=e.__k[r]=J(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):e.__k[r]=a,f=r+h,a.__=e,a.__b=e.__b+1,d=null,(_=a.__i=qe(a,n,f,o))!=-1&&(o--,(d=n[_])&&(d.__u|=2)),d==null||d.__v==null?(_==-1&&(l>u?h--:l<u&&h++),typeof a.type!="function"&&(a.__u|=4)):_!=f&&(_==f-1?h--:_==f+1?h++:(_>f?h--:h++,a.__u|=4))):e.__k[r]=null;if(o)for(r=0;r<u;r++)(d=n[r])!=null&&(2&d.__u)==0&&(d.__e==s&&(s=j(d)),De(d,d));return s}function He(e,t,n,s){var l,r;if(typeof e.type=="function"){for(l=e.__k,r=0;l&&r<l.length;r++)l[r]&&(l[r].__=e,t=He(l[r],t,n,s));return t}e.__e!=t&&(s&&(t&&e.type&&!t.parentNode&&(t=j(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function qe(e,t,n,s){var l,r,a,d=e.key,f=e.type,_=t[n],u=_!=null&&(2&_.__u)==0;if(_===null&&d==null||u&&d==_.key&&f==_.type)return n;if(s>(u?1:0)){for(l=n-1,r=n+1;l>=0||r<t.length;)if((_=t[a=l>=0?l--:r++])!=null&&(2&_.__u)==0&&d==_.key&&f==_.type)return a}return-1}function he(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||je.test(t)?n:n+"px"}function K(e,t,n,s,l){var r,a;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(t in s)n&&t in n||he(e.style,t,"");if(n)for(t in n)s&&n[t]==s[t]||he(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Te,"$1")),a=t.toLowerCase(),t=a in e||t=="onFocusOut"||t=="onFocusIn"?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?s?n.u=s.u:(n.u=ie,e.addEventListener(t,r?se:re,r)):e.removeEventListener(t,r?se:re,r);else{if(l=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function pe(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=ie++;else if(t.t<n.u)return;return n(w.event?w.event(t):t)}}}function _e(e,t,n,s,l,r,a,d,f,_){var u,o,h,v,p,C,$,b,k,N,R,O,I,G,W,S,c,y=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(f=!!(32&n.__u),r=[d=t.__e=n.__e]),(u=w.__b)&&u(t);e:if(typeof y=="function")try{if(b=t.props,k="prototype"in y&&y.prototype.render,N=(u=y.contextType)&&s[u.__c],R=u?N?N.props.value:u.__:s,n.__c?$=(o=t.__c=n.__c).__=o.__E:(k?t.__c=o=new y(b,R):(t.__c=o=new Q(b,R),o.constructor=y,o.render=Ve),N&&N.sub(o),o.state||(o.state={}),o.__n=s,h=o.__d=!0,o.__h=[],o._sb=[]),k&&o.__s==null&&(o.__s=o.state),k&&y.getDerivedStateFromProps!=null&&(o.__s==o.state&&(o.__s=H({},o.__s)),H(o.__s,y.getDerivedStateFromProps(b,o.__s))),v=o.props,p=o.state,o.__v=t,h)k&&y.getDerivedStateFromProps==null&&o.componentWillMount!=null&&o.componentWillMount(),k&&o.componentDidMount!=null&&o.__h.push(o.componentDidMount);else{if(k&&y.getDerivedStateFromProps==null&&b!==v&&o.componentWillReceiveProps!=null&&o.componentWillReceiveProps(b,R),t.__v==n.__v||!o.__e&&o.shouldComponentUpdate!=null&&o.shouldComponentUpdate(b,o.__s,R)===!1){for(t.__v!=n.__v&&(o.props=b,o.state=o.__s,o.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(m){m&&(m.__=t)}),O=0;O<o._sb.length;O++)o.__h.push(o._sb[O]);o._sb=[],o.__h.length&&a.push(o);break e}o.componentWillUpdate!=null&&o.componentWillUpdate(b,o.__s,R),k&&o.componentDidUpdate!=null&&o.__h.push(function(){o.componentDidUpdate(v,p,C)})}if(o.context=R,o.props=b,o.__P=e,o.__e=!1,I=w.__r,G=0,k){for(o.state=o.__s,o.__d=!1,I&&I(t),u=o.render(o.props,o.state,o.context),W=0;W<o._sb.length;W++)o.__h.push(o._sb[W]);o._sb=[]}else do o.__d=!1,I&&I(t),u=o.render(o.props,o.state,o.context),o.state=o.__s;while(o.__d&&++G<25);o.state=o.__s,o.getChildContext!=null&&(s=H(H({},s),o.getChildContext())),k&&!h&&o.getSnapshotBeforeUpdate!=null&&(C=o.getSnapshotBeforeUpdate(v,p)),S=u,u!=null&&u.type===V&&u.key==null&&(S=xe(u.props.children)),d=Ae(e,te(S)?S:[S],t,n,s,l,r,a,d,f,_),o.base=t.__e,t.__u&=-161,o.__h.length&&a.push(o),$&&(o.__E=o.__=null)}catch(m){if(t.__v=null,f||r!=null)if(m.then){for(t.__u|=f?160:128;d&&d.nodeType==8&&d.nextSibling;)d=d.nextSibling;r[r.indexOf(d)]=null,t.__e=d}else{for(c=r.length;c--;)ae(r[c]);oe(t)}else t.__e=n.__e,t.__k=n.__k,m.then||oe(t);w.__e(m,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):d=t.__e=ze(n.__e,t,n,s,l,r,a,f,_);return(u=w.diffed)&&u(t),128&t.__u?void 0:d}function oe(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(oe)}function Ue(e,t,n){for(var s=0;s<n.length;s++)ce(n[s],n[++s],n[++s]);w.__c&&w.__c(t,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(r){r.call(l)})}catch(r){w.__e(r,l.__v)}})}function xe(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:te(e)?e.map(xe):H({},e)}function ze(e,t,n,s,l,r,a,d,f){var _,u,o,h,v,p,C,$=n.props||q,b=t.props,k=t.type;if(k=="svg"?l="http://www.w3.org/2000/svg":k=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),r!=null){for(_=0;_<r.length;_++)if((v=r[_])&&"setAttribute"in v==!!k&&(k?v.localName==k:v.nodeType==3)){e=v,r[_]=null;break}}if(e==null){if(k==null)return document.createTextNode(b);e=document.createElementNS(l,k,b.is&&b),d&&(w.__m&&w.__m(t,r),d=!1),r=null}if(k==null)$===b||d&&e.data==b||(e.data=b);else{if(r=r&&ee.call(e.childNodes),!d&&r!=null)for($={},_=0;_<e.attributes.length;_++)$[(v=e.attributes[_]).name]=v.value;for(_ in $)if(v=$[_],_!="children"){if(_=="dangerouslySetInnerHTML")o=v;else if(!(_ in b)){if(_=="value"&&"defaultValue"in b||_=="checked"&&"defaultChecked"in b)continue;K(e,_,null,v,l)}}for(_ in b)v=b[_],_=="children"?h=v:_=="dangerouslySetInnerHTML"?u=v:_=="value"?p=v:_=="checked"?C=v:d&&typeof v!="function"||$[_]===v||K(e,_,v,$[_],l);if(u)d||o&&(u.__html==o.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(o&&(e.innerHTML=""),Ae(t.type=="template"?e.content:e,te(h)?h:[h],t,n,s,k=="foreignObject"?"http://www.w3.org/1999/xhtml":l,r,a,r?r[0]:n.__k&&j(n,0),d,f),r!=null)for(_=r.length;_--;)ae(r[_]);d||(_="value",k=="progress"&&p==null?e.removeAttribute("value"):p!=null&&(p!==e[_]||k=="progress"&&!p||k=="option"&&p!=$[_])&&K(e,_,p,$[_],l),_="checked",C!=null&&C!=e[_]&&K(e,_,C,$[_],l))}return e}function ce(e,t,n){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&t==null||(e.__u=e(t))}else e.current=t}catch(l){w.__e(l,n)}}function De(e,t,n){var s,l;if(w.unmount&&w.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||ce(s,null,t)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(r){w.__e(r,t)}s.base=s.__P=null}if(s=e.__k)for(l=0;l<s.length;l++)s[l]&&De(s[l],t,n||typeof e.type!="function");n||ae(e.__e),e.__c=e.__=e.__e=void 0}function Ve(e,t,n){return this.constructor(e,n)}function Ge(e,t,n){var s,l,r,a;t==document&&(t=document.documentElement),w.__&&w.__(e,t),l=(s=!1)?null:t.__k,r=[],a=[],_e(t,e=t.__k=Be(V,null,[e]),l||q,q,t.namespaceURI,l?null:t.firstChild?ee.call(t.childNodes):null,r,l?l.__e:t.firstChild,s,a),Ue(r,e,a)}ee=Ne.slice,w={__e:function(e,t,n,s){for(var l,r,a;t=t.__;)if((l=t.__c)&&!l.__)try{if((r=l.constructor)&&r.getDerivedStateFromError!=null&&(l.setState(r.getDerivedStateFromError(e)),a=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,s||{}),a=l.__d),a)return l.__E=l}catch(d){e=d}throw e}},Pe=0,Q.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=H({},this.state),typeof e=="function"&&(e=e(H({},n),this.props)),e&&H(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),fe(this))},Q.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),fe(this))},Q.prototype.render=V,F=[],Ee=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Se=function(e,t){return e.__v.__b-t.__v.__b},Y.__r=0,Te=/(PointerCapture)$|Capture$/i,ie=0,re=pe(!1),se=pe(!0);var Ke=0;function i(e,t,n,s,l,r){t||(t={});var a,d,f=t;if("ref"in f)for(d in f={},t)d=="ref"?a=t[d]:f[d]=t[d];var _={type:e,props:f,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ke,__i:-1,__u:0,__source:l,__self:r};if(typeof e=="function"&&(a=e.defaultProps))for(d in a)f[d]===void 0&&(f[d]=a[d]);return w.vnode&&w.vnode(_),_}const Je="modulepreload",Qe=function(e,t){return new URL(e,t).href},ve={},Xe=function(t,n,s){let l=Promise.resolve();if(n&&n.length>0){let a=function(u){return Promise.all(u.map(o=>Promise.resolve(o).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const d=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),_=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));l=a(n.map(u=>{if(u=Qe(u,s),u in ve)return;ve[u]=!0;const o=u.endsWith(".css"),h=o?'[rel="stylesheet"]':"";if(!!s)for(let C=d.length-1;C>=0;C--){const $=d[C];if($.href===u&&(!o||$.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${h}`))return;const p=document.createElement("link");if(p.rel=o?"stylesheet":Je,o||(p.as="script"),p.crossOrigin="",p.href=u,_&&p.setAttribute("nonce",_),document.head.appendChild(p),o)return new Promise((C,$)=>{p.addEventListener("load",C),p.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(a){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=a,window.dispatchEvent(d),!d.defaultPrevented)throw a}return l.then(a=>{for(const d of a||[])d.status==="rejected"&&r(d.reason);return t().catch(r)})};var z,L,ne,me,Z=0,Ie=[],P=w,ge=P.__b,ye=P.__r,ke=P.diffed,be=P.__c,we=P.unmount,$e=P.__;function de(e,t){P.__h&&P.__h(L,e,Z||t),Z=0;var n=L.__H||(L.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function D(e){return Z=1,Ye(Oe,e)}function Ye(e,t,n){var s=de(z++,2);if(s.t=e,!s.__c&&(s.__=[Oe(void 0,t),function(d){var f=s.__N?s.__N[0]:s.__[0],_=s.t(f,d);f!==_&&(s.__N=[_,s.__[1]],s.__c.setState({}))}],s.__c=L,!L.__f)){var l=function(d,f,_){if(!s.__c.__H)return!0;var u=s.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!r||r.call(this,d,f,_);var o=s.__c.props!==d;return u.forEach(function(h){if(h.__N){var v=h.__[0];h.__=h.__N,h.__N=void 0,v!==h.__[0]&&(o=!0)}}),r&&r.call(this,d,f,_)||o};L.__f=!0;var r=L.shouldComponentUpdate,a=L.componentWillUpdate;L.componentWillUpdate=function(d,f,_){if(this.__e){var u=r;r=void 0,l(d,f,_),r=u}a&&a.call(this,d,f,_)},L.shouldComponentUpdate=l}return s.__N||s.__}function Ze(e,t){var n=de(z++,3);!P.__s&&Fe(n.__H,t)&&(n.__=e,n.u=t,L.__H.__h.push(n))}function et(e){return Z=5,tt(function(){return{current:e}},[])}function tt(e,t){var n=de(z++,7);return Fe(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function nt(){for(var e;e=Ie.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(X),e.__H.__h.forEach(le),e.__H.__h=[]}catch(t){e.__H.__h=[],P.__e(t,e.__v)}}P.__b=function(e){L=null,ge&&ge(e)},P.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),$e&&$e(e,t)},P.__r=function(e){ye&&ye(e),z=0;var t=(L=e.__c).__H;t&&(ne===L?(t.__h=[],L.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(X),t.__h.forEach(le),t.__h=[],z=0)),ne=L},P.diffed=function(e){ke&&ke(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ie.push(t)!==1&&me===P.requestAnimationFrame||((me=P.requestAnimationFrame)||rt)(nt)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ne=L=null},P.__c=function(e,t){t.some(function(n){try{n.__h.forEach(X),n.__h=n.__h.filter(function(s){return!s.__||le(s)})}catch(s){t.some(function(l){l.__h&&(l.__h=[])}),t=[],P.__e(s,n.__v)}}),be&&be(e,t)},P.unmount=function(e){we&&we(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(s){try{X(s)}catch(l){t=l}}),n.__H=void 0,t&&P.__e(t,n.__v))};var Ce=typeof requestAnimationFrame=="function";function rt(e){var t,n=function(){clearTimeout(s),Ce&&cancelAnimationFrame(t),setTimeout(e)},s=setTimeout(n,35);Ce&&(t=requestAnimationFrame(n))}function X(e){var t=L,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),L=t}function le(e){var t=L;e.__c=e.__(),L=t}function Fe(e,t){return!e||e.length!==t.length||t.some(function(n,s){return n!==e[s]})}function Oe(e,t){return typeof t=="function"?t(e):t}async function st(){const e=await fetch("./demo-trainings.json",{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to load demo-trainings.json (${e.status})`);const t=await e.json();if(!Array.isArray(t))throw new Error("demo-trainings.json is not an array");return t}function We(){const e=new URLSearchParams(window.location.search);return{site:e.get("site"),list:e.get("list"),mode:e.get("mode")}}function ot(){const e=We();return e.mode==="sharepoint"?"sharepoint":e.mode==="demo"?"demo_json":window.location.hostname.includes("sharepoint.com")?"sharepoint":"demo_json"}const Le=We(),M={dataSource:ot(),sharepoint:{siteRelativeUrl:Le.site||"/sites/EuroWCPHE",listTitle:Le.list||"Copytraininglist2912026"}};function lt(){const[e,t]=D(null),[n,s]=D([]),[l,r]=D(!1),[a,d]=D(0),[f,_]=D(!0),[u,o]=D(null),[h,v]=D(null),[p,C]=D(null),$=et(!1);Ze(()=>{b()},[]);async function b(){_(!0),o(null);try{const c=M.dataSource==="demo_json"?await st():await k();t(c),s(c.map(y=>({record:y,status:"pending"})))}catch(c){console.error("Failed to load data:",c),o("Failed to load training data. Check your SharePoint permissions.")}finally{_(!1)}}async function k(){const{fetchAllListItems:c}=await Xe(async()=>{const{fetchAllListItems:y}=await import("./sharepoint-BSZBMNpd.js");return{fetchAllListItems:y}},[],import.meta.url);return c({siteRelativeUrl:M.sharepoint.siteRelativeUrl,listTitle:M.sharepoint.listTitle})}async function N(c){var T,U,E;const y=Date.now(),m=1e4;try{const g=new AbortController,x=setTimeout(()=>g.abort(),m),A=await fetch(c,{method:"HEAD",mode:"no-cors",signal:g.signal});clearTimeout(x);const B=Date.now()-y;return A.type==="opaque"?{status:"ok",responseTime:B}:A.ok?{status:"ok",statusCode:A.status,responseTime:B}:A.status>=300&&A.status<400?{status:"warning",statusCode:A.status,error:"Redirect",responseTime:B}:A.status===404?{status:"error",statusCode:404,error:"Not Found",responseTime:B}:{status:"error",statusCode:A.status,error:`HTTP ${A.status}`,responseTime:B}}catch(g){const x=Date.now()-y;return g.name==="AbortError"?{status:"timeout",error:"Timeout (>10s)",responseTime:x}:(T=g.message)!=null&&T.includes("Failed to fetch")||(U=g.message)!=null&&U.includes("NetworkError")||(E=g.message)!=null&&E.includes("Network request failed")?{status:"ok",error:"CORS (assumed OK)",responseTime:x}:{status:"warning",error:g.message||"Unknown error",responseTime:x}}}function R(c){const y=(c.modalityRaw||c.modality||"").toLowerCase();return y.includes("person")||y.includes("face")||y.includes("classroom")}function O(c){const y=(c.modalityRaw||c.modality||"").toLowerCase();return y.includes("blended")||y.includes("hybrid")}async function I(){if(!e||l)return;r(!0),d(0),$.current=!1,s(e.map(m=>({record:m,status:"pending"})));const c=e.length;let y=0;for(let m=0;m<e.length;m++){if($.current){r(!1);return}const T=e[m],U=T.normalizedLink;if(s(E=>{const g=[...E];return g[m]={...g[m],status:"checking"},g}),!U)R(T)?s(E=>{const g=[...E];return g[m]={record:T,status:"in_person",details:"In-person training - no URL needed"},g}):O(T)?s(E=>{const g=[...E];return g[m]={record:T,status:"blended",details:"Blended training - URL may vary"},g}):s(E=>{const g=[...E];return g[m]={record:T,status:"warning",error:"No URL provided for online training"},g});else{const E=await N(U);s(g=>{const x=[...g];return x[m]={record:T,...E},x})}y++,d(Math.round(y/c*100)),await new Promise(E=>setTimeout(E,100))}r(!1)}function G(){$.current=!0,r(!1)}function W(){const c=n.filter(g=>g.status==="error"||g.status==="timeout"),y=n.filter(g=>g.status==="warning");let m=`WHO PHHE Training Link Validation Report
`;m+=`Generated: ${new Date().toLocaleString()}
`,m+=`Source: ${M.dataSource==="demo_json"?"Demo Data":M.sharepoint.listTitle}

`,m+=`Summary:
`,m+=`- Total trainings: ${n.length}
`,m+=`- Working links: ${n.filter(g=>g.status==="ok").length}
`,m+=`- Broken links: ${c.length}
`,m+=`- Warnings: ${y.length}

`,c.length>0&&(m+=`
=== BROKEN LINKS ===

`,c.forEach(g=>{m+=`Training: ${g.record.learningName}
`,m+=`URL: ${g.record.normalizedLink||"N/A"}
`,m+=`Error: ${g.error||g.status}

`})),y.length>0&&(m+=`
=== WARNINGS ===

`,y.forEach(g=>{m+=`Training: ${g.record.learningName}
`,m+=`URL: ${g.record.normalizedLink||"N/A"}
`,m+=`Issue: ${g.error||g.status}

`}));const T=new Blob([m],{type:"text/plain"}),U=URL.createObjectURL(T),E=document.createElement("a");E.href=U,E.download=`link-validation-${new Date().toISOString().split("T")[0]}.txt`,E.click(),URL.revokeObjectURL(U)}const S={total:n.length,ok:n.filter(c=>c.status==="ok").length,inPerson:n.filter(c=>c.status==="in_person").length,blended:n.filter(c=>c.status==="blended").length,authRequired:n.filter(c=>c.status==="auth_required").length,warning:n.filter(c=>c.status==="warning").length,error:n.filter(c=>c.status==="error"||c.status==="timeout").length,pending:n.filter(c=>c.status==="pending"||c.status==="checking").length};return i("div",{class:"validator-container",children:[i("div",{class:"validator-header",children:i("div",{class:"validator-header-text",children:[i("span",{class:"validator-title",children:"WHO PHHE Link Validator"}),i("span",{class:"validator-subtitle",children:"Check training links for availability"})]})}),i("div",{class:"validator-content",children:[f&&i("div",{class:"validator-loading",children:"Loading training data..."}),u&&i("div",{class:"validator-error",children:u}),!f&&!u&&e&&i(V,{children:[i("div",{class:"validator-controls",children:[l?i("button",{class:"validator-btn stop",onClick:G,children:["â¹ Stop (",a,"%)"]}):i("button",{class:"validator-btn primary",onClick:I,children:"Start Validation"}),(S.error>0||S.warning>0)&&!l&&i("button",{class:"validator-btn secondary",onClick:W,children:"Export Report"})]}),l&&i("div",{class:"validator-progress",children:i("div",{class:"progress-bar-bg",children:i("div",{class:"progress-bar-fill",style:{width:`${a}%`}})})}),i("div",{class:"validator-stats",children:[i("div",{class:`stat clickable ${p===null?"selected":""}`,onClick:()=>C(null),children:[i("span",{class:"stat-value",children:S.total}),i("span",{class:"stat-label",children:"Total"})]}),i("div",{class:`stat ok clickable ${p==="ok"?"selected":""}`,onClick:()=>C(p==="ok"?null:"ok"),children:[i("span",{class:"stat-value",children:S.ok}),i("span",{class:"stat-label",children:"Working"})]}),i("div",{class:`stat in-person clickable ${p==="in_person"?"selected":""}`,onClick:()=>C(p==="in_person"?null:"in_person"),children:[i("span",{class:"stat-value",children:S.inPerson}),i("span",{class:"stat-label",children:"In-person"})]}),i("div",{class:`stat blended clickable ${p==="blended"?"selected":""}`,onClick:()=>C(p==="blended"?null:"blended"),children:[i("span",{class:"stat-value",children:S.blended}),i("span",{class:"stat-label",children:"Blended"})]}),i("div",{class:`stat warning clickable ${p==="warning"?"selected":""}`,onClick:()=>C(p==="warning"?null:"warning"),children:[i("span",{class:"stat-value",children:S.warning}),i("span",{class:"stat-label",children:"Warnings"})]}),i("div",{class:`stat error clickable ${p==="error"?"selected":""}`,onClick:()=>C(p==="error"?null:"error"),children:[i("span",{class:"stat-value",children:S.error}),i("span",{class:"stat-label",children:"Broken"})]})]}),p&&i("div",{class:"filter-indicator",children:["Showing: ",i("strong",{children:p==="ok"?"Working":p==="in_person"?"In-person":p==="blended"?"Blended":p==="warning"?"Warnings":"Broken"}),i("button",{class:"clear-filter",onClick:()=>C(null),children:"âœ• Clear"})]}),i("div",{class:"validator-results",children:n.filter(c=>p?p==="error"?c.status==="error"||c.status==="timeout":c.status===p:!0).map((c,y)=>{var m;return i("div",{class:`result-row ${c.status} ${h===y?"expanded":""}`,onClick:()=>v(h===y?null:y),children:[i("div",{class:"result-header",children:[i("div",{class:"result-status",children:[c.status==="pending"&&i("span",{class:"status-icon",children:"â—‹"}),c.status==="checking"&&i("span",{class:"status-icon spin",children:"â—Œ"}),c.status==="ok"&&i("span",{class:"status-icon",children:"âœ“"}),c.status==="in_person"&&i("span",{class:"status-icon",children:"ðŸ‘¤"}),c.status==="blended"&&i("span",{class:"status-icon",children:"ðŸ”€"}),c.status==="auth_required"&&i("span",{class:"status-icon",children:"ðŸ”"}),c.status==="warning"&&i("span",{class:"status-icon",children:"âš "}),(c.status==="error"||c.status==="timeout")&&i("span",{class:"status-icon",children:"âœ—"})]}),i("div",{class:"result-info",children:[i("div",{class:"result-name",children:c.record.learningName}),!h&&c.error&&i("div",{class:"result-error",children:c.error}),!h&&c.details&&i("div",{class:"result-details-hint",children:c.details})]}),c.responseTime!==void 0&&i("div",{class:"result-time",children:[c.responseTime,"ms"]}),i("div",{class:"result-expand-icon",children:h===y?"â–¼":"â–¶"})]}),h===y&&i("div",{class:"result-expanded",children:[i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"URL"}),i("span",{class:"detail-value",children:c.record.normalizedLink?i("a",{href:c.record.normalizedLink,target:"_blank",rel:"noopener noreferrer",onClick:T=>T.stopPropagation(),children:c.record.normalizedLink}):"No URL"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Description"}),i("span",{class:"detail-value",children:c.record.description||"N/A"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Modality"}),i("span",{class:"detail-value",children:c.record.modalityRaw||c.record.modality||"N/A"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Technical Area"}),i("span",{class:"detail-value",children:c.record.technicalArea||"N/A"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Languages"}),i("span",{class:"detail-value",children:((m=c.record.languages)==null?void 0:m.join(", "))||"N/A"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Platform"}),i("span",{class:"detail-value",children:c.record.platform||"N/A"})]}),i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Owner"}),i("span",{class:"detail-value",children:c.record.owner||"N/A"})]}),c.error&&i("div",{class:"detail-row error-row",children:[i("span",{class:"detail-label",children:"Error"}),i("span",{class:"detail-value",children:c.error})]}),c.details&&i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"Note"}),i("span",{class:"detail-value",children:c.details})]}),c.statusCode&&i("div",{class:"detail-row",children:[i("span",{class:"detail-label",children:"HTTP Status"}),i("span",{class:"detail-value",children:c.statusCode})]})]})]},c.record.id||y)})})]})]})]})}Ge(i(lt,{}),document.getElementById("app"));
