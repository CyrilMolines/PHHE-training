(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))o(_);new MutationObserver(_=>{for(const r of _)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(_){const r={};return _.integrity&&(r.integrity=_.integrity),_.referrerPolicy&&(r.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?r.credentials="include":_.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(_){if(_.ep)return;_.ep=!0;const r=n(_);fetch(_.href,r)}})();var z,k,ge,U,se,ye,ke,we,te,Q,X,O={},be=[],Re=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,G=Array.isArray;function R(e,t){for(var n in t)e[n]=t[n];return e}function ne(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ue(e,t,n){var o,_,r,i={};for(r in t)r=="key"?o=t[r]:r=="ref"?_=t[r]:i[r]=t[r];if(arguments.length>2&&(i.children=arguments.length>3?z.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)i[r]===void 0&&(i[r]=e.defaultProps[r]);return j(e,i,o,_,null)}function j(e,t,n,o,_){var r={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:_??++ge,__i:-1,__u:0};return _==null&&k.vnode!=null&&k.vnode(r),r}function I(e){return e.children}function M(e,t){this.props=e,this.context=t}function D(e,t){if(t==null)return e.__?D(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?D(e):null}function $e(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return $e(e)}}function _e(e){(!e.__d&&(e.__d=!0)&&U.push(e)&&!q.__r++||se!=k.debounceRendering)&&((se=k.debounceRendering)||ye)(q)}function q(){for(var e,t,n,o,_,r,i,a=1;U.length;)U.length>a&&U.sort(ke),e=U.shift(),a=U.length,e.__d&&(n=void 0,o=void 0,_=(o=(t=e).__v).__e,r=[],i=[],t.__P&&((n=R({},o)).__v=o.__v+1,k.vnode&&k.vnode(n),re(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[_]:null,r,_??D(o),!!(32&o.__u),i),n.__v=o.__v,n.__.__k[n.__i]=n,Se(r,n,i),o.__e=o.__=null,n.__e!=_&&$e(n)));q.__r=0}function Ee(e,t,n,o,_,r,i,a,d,l,u){var s,h,f,y,S,w,g,c=o&&o.__k||be,b=t.length;for(d=Ae(n,t,c,d,b),s=0;s<b;s++)(f=n.__k[s])!=null&&(h=f.__i==-1?O:c[f.__i]||O,f.__i=s,w=re(e,f,h,_,r,i,a,d,l,u),y=f.__e,f.ref&&h.ref!=f.ref&&(h.ref&&oe(h.ref,null,f),u.push(f.ref,f.__c||y,f)),S==null&&y!=null&&(S=y),(g=!!(4&f.__u))||h.__k===f.__k?d=Pe(f,d,e,g):typeof f.type=="function"&&w!==void 0?d=w:y&&(d=y.nextSibling),f.__u&=-7);return n.__e=S,d}function Ae(e,t,n,o,_){var r,i,a,d,l,u=n.length,s=u,h=0;for(e.__k=new Array(_),r=0;r<_;r++)(i=t[r])!=null&&typeof i!="boolean"&&typeof i!="function"?(typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?i=e.__k[r]=j(null,i,null,null,null):G(i)?i=e.__k[r]=j(I,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?i=e.__k[r]=j(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):e.__k[r]=i,d=r+h,i.__=e,i.__b=e.__b+1,a=null,(l=i.__i=xe(i,n,d,s))!=-1&&(s--,(a=n[l])&&(a.__u|=2)),a==null||a.__v==null?(l==-1&&(_>u?h--:_<u&&h++),typeof i.type!="function"&&(i.__u|=4)):l!=d&&(l==d-1?h--:l==d+1?h++:(l>d?h--:h++,i.__u|=4))):e.__k[r]=null;if(s)for(r=0;r<u;r++)(a=n[r])!=null&&(2&a.__u)==0&&(a.__e==o&&(o=D(a)),Te(a,a));return o}function Pe(e,t,n,o){var _,r;if(typeof e.type=="function"){for(_=e.__k,r=0;_&&r<_.length;r++)_[r]&&(_[r].__=e,t=Pe(_[r],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=D(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function xe(e,t,n,o){var _,r,i,a=e.key,d=e.type,l=t[n],u=l!=null&&(2&l.__u)==0;if(l===null&&a==null||u&&a==l.key&&d==l.type)return n;if(o>(u?1:0)){for(_=n-1,r=n+1;_>=0||r<t.length;)if((l=t[i=_>=0?_--:r++])!=null&&(2&l.__u)==0&&a==l.key&&d==l.type)return i}return-1}function ie(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Re.test(t)?n:n+"px"}function W(e,t,n,o,_){var r,i;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||ie(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||ie(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(we,"$1")),i=t.toLowerCase(),t=i in e||t=="onFocusOut"||t=="onFocusIn"?i.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o?n.u=o.u:(n.u=te,e.addEventListener(t,r?X:Q,r)):e.removeEventListener(t,r?X:Q,r);else{if(_=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function le(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=te++;else if(t.t<n.u)return;return n(k.event?k.event(t):t)}}}function re(e,t,n,o,_,r,i,a,d,l){var u,s,h,f,y,S,w,g,c,b,v,C,T,$,m,L,H,N=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(d=!!(32&n.__u),r=[a=t.__e=n.__e]),(u=k.__b)&&u(t);e:if(typeof N=="function")try{if(g=t.props,c="prototype"in N&&N.prototype.render,b=(u=N.contextType)&&o[u.__c],v=u?b?b.props.value:u.__:o,n.__c?w=(s=t.__c=n.__c).__=s.__E:(c?t.__c=s=new N(g,v):(t.__c=s=new M(g,v),s.constructor=N,s.render=Fe),b&&b.sub(s),s.state||(s.state={}),s.__n=o,h=s.__d=!0,s.__h=[],s._sb=[]),c&&s.__s==null&&(s.__s=s.state),c&&N.getDerivedStateFromProps!=null&&(s.__s==s.state&&(s.__s=R({},s.__s)),R(s.__s,N.getDerivedStateFromProps(g,s.__s))),f=s.props,y=s.state,s.__v=t,h)c&&N.getDerivedStateFromProps==null&&s.componentWillMount!=null&&s.componentWillMount(),c&&s.componentDidMount!=null&&s.__h.push(s.componentDidMount);else{if(c&&N.getDerivedStateFromProps==null&&g!==f&&s.componentWillReceiveProps!=null&&s.componentWillReceiveProps(g,v),t.__v==n.__v||!s.__e&&s.shouldComponentUpdate!=null&&s.shouldComponentUpdate(g,s.__s,v)===!1){for(t.__v!=n.__v&&(s.props=g,s.state=s.__s,s.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(A){A&&(A.__=t)}),C=0;C<s._sb.length;C++)s.__h.push(s._sb[C]);s._sb=[],s.__h.length&&i.push(s);break e}s.componentWillUpdate!=null&&s.componentWillUpdate(g,s.__s,v),c&&s.componentDidUpdate!=null&&s.__h.push(function(){s.componentDidUpdate(f,y,S)})}if(s.context=v,s.props=g,s.__P=e,s.__e=!1,T=k.__r,$=0,c){for(s.state=s.__s,s.__d=!1,T&&T(t),u=s.render(s.props,s.state,s.context),m=0;m<s._sb.length;m++)s.__h.push(s._sb[m]);s._sb=[]}else do s.__d=!1,T&&T(t),u=s.render(s.props,s.state,s.context),s.state=s.__s;while(s.__d&&++$<25);s.state=s.__s,s.getChildContext!=null&&(o=R(R({},o),s.getChildContext())),c&&!h&&s.getSnapshotBeforeUpdate!=null&&(S=s.getSnapshotBeforeUpdate(f,y)),L=u,u!=null&&u.type===I&&u.key==null&&(L=Le(u.props.children)),a=Ee(e,G(L)?L:[L],t,n,o,_,r,i,a,d,l),s.base=t.__e,t.__u&=-161,s.__h.length&&i.push(s),w&&(s.__E=s.__=null)}catch(A){if(t.__v=null,d||r!=null)if(A.then){for(t.__u|=d?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;r[r.indexOf(a)]=null,t.__e=a}else{for(H=r.length;H--;)ne(r[H]);Y(t)}else t.__e=n.__e,t.__k=n.__k,A.then||Y(t);k.__e(A,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):a=t.__e=De(n.__e,t,n,o,_,r,i,d,l);return(u=k.diffed)&&u(t),128&t.__u?void 0:a}function Y(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Y)}function Se(e,t,n){for(var o=0;o<n.length;o++)oe(n[o],n[++o],n[++o]);k.__c&&k.__c(t,e),e.some(function(_){try{e=_.__h,_.__h=[],e.some(function(r){r.call(_)})}catch(r){k.__e(r,_.__v)}})}function Le(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:G(e)?e.map(Le):R({},e)}function De(e,t,n,o,_,r,i,a,d){var l,u,s,h,f,y,S,w=n.props||O,g=t.props,c=t.type;if(c=="svg"?_="http://www.w3.org/2000/svg":c=="math"?_="http://www.w3.org/1998/Math/MathML":_||(_="http://www.w3.org/1999/xhtml"),r!=null){for(l=0;l<r.length;l++)if((f=r[l])&&"setAttribute"in f==!!c&&(c?f.localName==c:f.nodeType==3)){e=f,r[l]=null;break}}if(e==null){if(c==null)return document.createTextNode(g);e=document.createElementNS(_,c,g.is&&g),a&&(k.__m&&k.__m(t,r),a=!1),r=null}if(c==null)w===g||a&&e.data==g||(e.data=g);else{if(r=r&&z.call(e.childNodes),!a&&r!=null)for(w={},l=0;l<e.attributes.length;l++)w[(f=e.attributes[l]).name]=f.value;for(l in w)if(f=w[l],l!="children"){if(l=="dangerouslySetInnerHTML")s=f;else if(!(l in g)){if(l=="value"&&"defaultValue"in g||l=="checked"&&"defaultChecked"in g)continue;W(e,l,null,f,_)}}for(l in g)f=g[l],l=="children"?h=f:l=="dangerouslySetInnerHTML"?u=f:l=="value"?y=f:l=="checked"?S=f:a&&typeof f!="function"||w[l]===f||W(e,l,f,w[l],_);if(u)a||s&&(u.__html==s.__html||u.__html==e.innerHTML)||(e.innerHTML=u.__html),t.__k=[];else if(s&&(e.innerHTML=""),Ee(t.type=="template"?e.content:e,G(h)?h:[h],t,n,o,c=="foreignObject"?"http://www.w3.org/1999/xhtml":_,r,i,r?r[0]:n.__k&&D(n,0),a,d),r!=null)for(l=r.length;l--;)ne(r[l]);a||(l="value",c=="progress"&&y==null?e.removeAttribute("value"):y!=null&&(y!==e[l]||c=="progress"&&!y||c=="option"&&y!=w[l])&&W(e,l,y,w[l],_),l="checked",S!=null&&S!=e[l]&&W(e,l,S,w[l],_))}return e}function oe(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(_){k.__e(_,n)}}function Te(e,t,n){var o,_;if(k.unmount&&k.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||oe(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){k.__e(r,t)}o.base=o.__P=null}if(o=e.__k)for(_=0;_<o.length;_++)o[_]&&Te(o[_],t,n||typeof e.type!="function");n||ne(e.__e),e.__c=e.__=e.__e=void 0}function Fe(e,t,n){return this.constructor(e,n)}function Oe(e,t,n){var o,_,r,i;t==document&&(t=document.documentElement),k.__&&k.__(e,t),_=(o=!1)?null:t.__k,r=[],i=[],re(t,e=t.__k=Ue(I,null,[e]),_||O,O,t.namespaceURI,_?null:t.firstChild?z.call(t.childNodes):null,r,_?_.__e:t.firstChild,o,i),Se(r,e,i)}z=be.slice,k={__e:function(e,t,n,o){for(var _,r,i;t=t.__;)if((_=t.__c)&&!_.__)try{if((r=_.constructor)&&r.getDerivedStateFromError!=null&&(_.setState(r.getDerivedStateFromError(e)),i=_.__d),_.componentDidCatch!=null&&(_.componentDidCatch(e,o||{}),i=_.__d),i)return _.__E=_}catch(a){e=a}throw e}},ge=0,M.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=R({},this.state),typeof e=="function"&&(e=e(R({},n),this.props)),e&&R(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),_e(this))},M.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),_e(this))},M.prototype.render=I,U=[],ye=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,ke=function(e,t){return e.__v.__b-t.__v.__b},q.__r=0,we=/(PointerCapture)$|Capture$/i,te=0,Q=le(!1),X=le(!0);var Ie=0;function p(e,t,n,o,_,r){t||(t={});var i,a,d=t;if("ref"in d)for(a in d={},t)a=="ref"?i=t[a]:d[a]=t[a];var l={type:e,props:d,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ie,__i:-1,__u:0,__source:_,__self:r};if(typeof e=="function"&&(i=e.defaultProps))for(a in i)d[a]===void 0&&(d[a]=i[a]);return k.vnode&&k.vnode(l),l}const We="modulepreload",je=function(e,t){return new URL(e,t).href},ae={},Me=function(t,n,o){let _=Promise.resolve();if(n&&n.length>0){let i=function(u){return Promise.all(u.map(s=>Promise.resolve(s).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};const a=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),l=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));_=i(n.map(u=>{if(u=je(u,o),u in ae)return;ae[u]=!0;const s=u.endsWith(".css"),h=s?'[rel="stylesheet"]':"";if(!!o)for(let S=a.length-1;S>=0;S--){const w=a[S];if(w.href===u&&(!s||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${h}`))return;const y=document.createElement("link");if(y.rel=s?"stylesheet":We,s||(y.as="script"),y.crossOrigin="",y.href=u,l&&y.setAttribute("nonce",l),document.head.appendChild(y),s)return new Promise((S,w)=>{y.addEventListener("load",S),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return _.then(i=>{for(const a of i||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})};var V,E,K,ce,Z=0,Ce=[],P=k,ue=P.__b,de=P.__r,fe=P.diffed,he=P.__c,pe=P.unmount,me=P.__;function Ne(e,t){P.__h&&P.__h(E,e,Z||t),Z=0;var n=E.__H||(E.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function x(e){return Z=1,Be(He,e)}function Be(e,t,n){var o=Ne(V++,2);if(o.t=e,!o.__c&&(o.__=[He(void 0,t),function(a){var d=o.__N?o.__N[0]:o.__[0],l=o.t(d,a);d!==l&&(o.__N=[l,o.__[1]],o.__c.setState({}))}],o.__c=E,!E.__f)){var _=function(a,d,l){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(h){return!!h.__c});if(u.every(function(h){return!h.__N}))return!r||r.call(this,a,d,l);var s=o.__c.props!==a;return u.forEach(function(h){if(h.__N){var f=h.__[0];h.__=h.__N,h.__N=void 0,f!==h.__[0]&&(s=!0)}}),r&&r.call(this,a,d,l)||s};E.__f=!0;var r=E.shouldComponentUpdate,i=E.componentWillUpdate;E.componentWillUpdate=function(a,d,l){if(this.__e){var u=r;r=void 0,_(a,d,l),r=u}i&&i.call(this,a,d,l)},E.shouldComponentUpdate=_}return o.__N||o.__}function qe(e,t){var n=Ne(V++,3);!P.__s&&Ge(n.__H,t)&&(n.__=e,n.u=t,E.__H.__h.push(n))}function Ve(){for(var e;e=Ce.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(B),e.__H.__h.forEach(ee),e.__H.__h=[]}catch(t){e.__H.__h=[],P.__e(t,e.__v)}}P.__b=function(e){E=null,ue&&ue(e)},P.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),me&&me(e,t)},P.__r=function(e){de&&de(e),V=0;var t=(E=e.__c).__H;t&&(K===E?(t.__h=[],E.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(B),t.__h.forEach(ee),t.__h=[],V=0)),K=E},P.diffed=function(e){fe&&fe(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ce.push(t)!==1&&ce===P.requestAnimationFrame||((ce=P.requestAnimationFrame)||ze)(Ve)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),K=E=null},P.__c=function(e,t){t.some(function(n){try{n.__h.forEach(B),n.__h=n.__h.filter(function(o){return!o.__||ee(o)})}catch(o){t.some(function(_){_.__h&&(_.__h=[])}),t=[],P.__e(o,n.__v)}}),he&&he(e,t)},P.unmount=function(e){pe&&pe(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{B(o)}catch(_){t=_}}),n.__H=void 0,t&&P.__e(t,n.__v))};var ve=typeof requestAnimationFrame=="function";function ze(e){var t,n=function(){clearTimeout(o),ve&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);ve&&(t=requestAnimationFrame(n))}function B(e){var t=E,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),E=t}function ee(e){var t=E;e.__c=e.__(),E=t}function Ge(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function He(e,t){return typeof t=="function"?t(e):t}async function Ke(){const e=await fetch("./demo-trainings.json",{credentials:"same-origin"});if(!e.ok)throw new Error(`Failed to load demo-trainings.json (${e.status})`);const t=await e.json();if(!Array.isArray(t))throw new Error("demo-trainings.json is not an array");return t}function Je(){const e=new URLSearchParams(window.location.search);return{site:e.get("site"),list:e.get("list"),mode:e.get("mode")}}const J=Je(),F={dataSource:J.mode==="demo"?"demo_json":"sharepoint",sharepoint:{siteRelativeUrl:J.site||"/sites/EuroWCPHE",listTitle:J.list||"Copytraininglist2912026"}};function Qe(){const[e,t]=x(null),[n,o]=x([]),[_,r]=x(!1),[i,a]=x(0),[d,l]=x(!0),[u,s]=x(null);qe(()=>{h()},[]);async function h(){l(!0),s(null);try{const c=F.dataSource==="demo_json"?await Ke():await f();t(c),o(c.map(b=>({record:b,status:"pending"})))}catch(c){console.error("Failed to load data:",c),s("Failed to load training data. Check your SharePoint permissions.")}finally{l(!1)}}async function f(){const{fetchAllListItems:c}=await Me(async()=>{const{fetchAllListItems:b}=await import("./sharepoint-BSZBMNpd.js");return{fetchAllListItems:b}},[],import.meta.url);return c({siteRelativeUrl:F.sharepoint.siteRelativeUrl,listTitle:F.sharepoint.listTitle})}async function y(c){var C,T;const b=Date.now(),v=1e4;try{const $=new AbortController,m=setTimeout(()=>$.abort(),v),L=await fetch(c,{method:"HEAD",mode:"no-cors",signal:$.signal});clearTimeout(m);const H=Date.now()-b;return L.type==="opaque"?{status:"ok",responseTime:H}:L.ok?{status:"ok",statusCode:L.status,responseTime:H}:L.status>=300&&L.status<400?{status:"warning",statusCode:L.status,error:"Redirect",responseTime:H}:L.status===404?{status:"error",statusCode:404,error:"Not Found",responseTime:H}:{status:"error",statusCode:L.status,error:`HTTP ${L.status}`,responseTime:H}}catch($){const m=Date.now()-b;return $.name==="AbortError"?{status:"timeout",error:"Timeout (>10s)",responseTime:m}:(C=$.message)!=null&&C.includes("Failed to fetch")||(T=$.message)!=null&&T.includes("NetworkError")?m<1e3?{status:"error",error:"Network Error",responseTime:m}:{status:"warning",error:"Could not verify (CORS)",responseTime:m}:{status:"error",error:$.message||"Unknown error",responseTime:m}}}async function S(){if(!e||_)return;r(!0),a(0),o(e.map(v=>({record:v,status:"pending"})));const c=e.length;let b=0;for(let v=0;v<e.length;v++){const C=e[v],T=C.normalizedLink;if(o($=>{const m=[...$];return m[v]={...m[v],status:"checking"},m}),!T)o($=>{const m=[...$];return m[v]={record:C,status:"warning",error:"No URL provided"},m});else{const $=await y(T);o(m=>{const L=[...m];return L[v]={record:C,...$},L})}b++,a(Math.round(b/c*100)),await new Promise($=>setTimeout($,100))}r(!1)}function w(){const c=n.filter(m=>m.status==="error"||m.status==="timeout"),b=n.filter(m=>m.status==="warning");let v=`WHO PHHE Training Link Validation Report
`;v+=`Generated: ${new Date().toLocaleString()}
`,v+=`Source: ${F.dataSource==="demo_json"?"Demo Data":F.sharepoint.listTitle}

`,v+=`Summary:
`,v+=`- Total trainings: ${n.length}
`,v+=`- Working links: ${n.filter(m=>m.status==="ok").length}
`,v+=`- Broken links: ${c.length}
`,v+=`- Warnings: ${b.length}

`,c.length>0&&(v+=`
=== BROKEN LINKS ===

`,c.forEach(m=>{v+=`Training: ${m.record.learningName}
`,v+=`URL: ${m.record.normalizedLink||"N/A"}
`,v+=`Error: ${m.error||m.status}

`})),b.length>0&&(v+=`
=== WARNINGS ===

`,b.forEach(m=>{v+=`Training: ${m.record.learningName}
`,v+=`URL: ${m.record.normalizedLink||"N/A"}
`,v+=`Issue: ${m.error||m.status}

`}));const C=new Blob([v],{type:"text/plain"}),T=URL.createObjectURL(C),$=document.createElement("a");$.href=T,$.download=`link-validation-${new Date().toISOString().split("T")[0]}.txt`,$.click(),URL.revokeObjectURL(T)}const g={total:n.length,ok:n.filter(c=>c.status==="ok").length,warning:n.filter(c=>c.status==="warning").length,error:n.filter(c=>c.status==="error"||c.status==="timeout").length,pending:n.filter(c=>c.status==="pending"||c.status==="checking").length};return p("div",{class:"validator-container",children:[p("div",{class:"validator-header",children:p("div",{class:"validator-header-text",children:[p("span",{class:"validator-title",children:"WHO PHHE Link Validator"}),p("span",{class:"validator-subtitle",children:"Check training links for availability"})]})}),p("div",{class:"validator-content",children:[d&&p("div",{class:"validator-loading",children:"Loading training data..."}),u&&p("div",{class:"validator-error",children:u}),!d&&!u&&e&&p(I,{children:[p("div",{class:"validator-controls",children:[p("button",{class:"validator-btn primary",onClick:S,disabled:_,children:_?`Checking... ${i}%`:"Start Validation"}),g.error>0&&!_&&p("button",{class:"validator-btn secondary",onClick:w,children:"Export Report"})]}),_&&p("div",{class:"validator-progress",children:p("div",{class:"progress-bar-bg",children:p("div",{class:"progress-bar-fill",style:{width:`${i}%`}})})}),p("div",{class:"validator-stats",children:[p("div",{class:"stat",children:[p("span",{class:"stat-value",children:g.total}),p("span",{class:"stat-label",children:"Total"})]}),p("div",{class:"stat ok",children:[p("span",{class:"stat-value",children:g.ok}),p("span",{class:"stat-label",children:"Working"})]}),p("div",{class:"stat warning",children:[p("span",{class:"stat-value",children:g.warning}),p("span",{class:"stat-label",children:"Warnings"})]}),p("div",{class:"stat error",children:[p("span",{class:"stat-value",children:g.error}),p("span",{class:"stat-label",children:"Broken"})]})]}),p("div",{class:"validator-results",children:n.map((c,b)=>p("div",{class:`result-row ${c.status}`,children:[p("div",{class:"result-status",children:[c.status==="pending"&&p("span",{class:"status-icon",children:"○"}),c.status==="checking"&&p("span",{class:"status-icon spin",children:"◌"}),c.status==="ok"&&p("span",{class:"status-icon",children:"✓"}),c.status==="warning"&&p("span",{class:"status-icon",children:"⚠"}),(c.status==="error"||c.status==="timeout")&&p("span",{class:"status-icon",children:"✗"})]}),p("div",{class:"result-info",children:[p("div",{class:"result-name",children:c.record.learningName}),p("div",{class:"result-url",children:c.record.normalizedLink||"No URL"}),c.error&&p("div",{class:"result-error",children:c.error})]}),c.responseTime!==void 0&&p("div",{class:"result-time",children:[c.responseTime,"ms"]})]},b))})]})]})]})}Oe(p(Qe,{}),document.getElementById("app"));
